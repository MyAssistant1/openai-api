<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flask Ses Kayıt</title>
</head>
<body>

<h1>Flask Ses Kayıt Uygulaması</h1>

<button onclick="startRecording()">Kaydı Başlat</button>
<button onclick="stopRecording()">Kaydı Bitir</button>

<p id="timer">Geçen Süre: 0 saniye</p>

<audio id="audioPlayer" controls></audio>

<script>
    let mediaRecorder;
    let audioChunks = [];
    let timerInterval;
    let elapsedTime = 0;

    function startRecording() {
        // Önceki kaydı durdur
        stopRecording();

        navigator.mediaDevices.getUserMedia({ audio: true })
            .then(stream => {
                mediaRecorder = new MediaRecorder(stream);

                mediaRecorder.ondataavailable = event => {
                    if (event.data.size > 0) {
                        audioChunks.push(event.data);
                    }
                };

                mediaRecorder.onstop = () => {
                    const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                    const audioUrl = URL.createObjectURL(audioBlob);
                    document.getElementById('audioPlayer').src = audioUrl;
                    clearInterval(timerInterval);
                };

                mediaRecorder.start();
                timerInterval = setInterval(updateTimer, 1000);
            })
            .catch(error => {
                console.error('Hata:', error);
            });
    }

    function stopRecording() {
        if (mediaRecorder && mediaRecorder.state !== 'inactive') {
            mediaRecorder.stop();
            audioChunks = []; // Önceki kaydı temizle
            elapsedTime = 0; // Süreyi sıfırla
            document.getElementById('timer').innerText = 'Geçen Süre: 0 saniye'; // Süre gösterimini sıfırla
        }
    }

    function updateTimer() {
        elapsedTime += 1;
        document.getElementById('timer').innerText = 'Geçen Süre: ' + elapsedTime + ' saniye';
    }
</script>
